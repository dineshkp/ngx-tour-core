!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common"),require("@angular/core"),require("@angular/router"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("ngx-tour-core",["exports","@angular/common","@angular/core","@angular/router","rxjs","rxjs/operators"],e):e((t=t||self)["ngx-tour-core"]={},t.ng.common,t.ng.core,t.ng.router,t.rxjs,t.rxjs.operators)}(this,(function(t,e,r,n,o,i){"use strict";var s;(s=t.TourState||(t.TourState={}))[s.OFF=0]="OFF",s[s.ON=1]="ON",s[s.PAUSED=2]="PAUSED";var u=function(){function e(e){this.router=e,this.stepShow$=new o.Subject,this.stepHide$=new o.Subject,this.initialize$=new o.Subject,this.start$=new o.Subject,this.end$=new o.Subject,this.pause$=new o.Subject,this.resume$=new o.Subject,this.anchorRegister$=new o.Subject,this.anchorUnregister$=new o.Subject,this.events$=o.merge(this.stepShow$.pipe(i.map((function(t){return{name:"stepShow",value:t}}))),this.stepHide$.pipe(i.map((function(t){return{name:"stepHide",value:t}}))),this.initialize$.pipe(i.map((function(t){return{name:"initialize",value:t}}))),this.start$.pipe(i.map((function(t){return{name:"start",value:t}}))),this.end$.pipe(i.map((function(t){return{name:"end",value:t}}))),this.pause$.pipe(i.map((function(t){return{name:"pause",value:t}}))),this.resume$.pipe(i.map((function(t){return{name:"resume",value:t}}))),this.anchorRegister$.pipe(i.map((function(t){return{name:"anchorRegister",value:t}}))),this.anchorUnregister$.pipe(i.map((function(t){return{name:"anchorUnregister",value:t}})))),this.steps=[],this.anchors={},this.status=t.TourState.OFF,this.isHotKeysEnabled=!0}return e.prototype.initialize=function(e,r){e&&e.length>0&&(this.status=t.TourState.OFF,this.steps=e.map((function(t){return Object.assign({},r,t)})),this.initialize$.next(this.steps))},e.prototype.disableHotkeys=function(){this.isHotKeysEnabled=!1},e.prototype.enableHotkeys=function(){this.isHotKeysEnabled=!0},e.prototype.start=function(){this.startAt(0)},e.prototype.startAt=function(e){var r=this;this.status=t.TourState.ON,this.goToStep(this.loadStep(e)),this.start$.next(),this.router.events.pipe(i.filter((function(t){return t instanceof n.NavigationStart})),i.first()).subscribe((function(){r.currentStep&&r.currentStep.hasOwnProperty("route")&&r.hideStep(r.currentStep)}))},e.prototype.end=function(){this.status=t.TourState.OFF,this.hideStep(this.currentStep),this.currentStep=void 0,this.end$.next()},e.prototype.pause=function(){this.status=t.TourState.PAUSED,this.hideStep(this.currentStep),this.pause$.next()},e.prototype.resume=function(){this.status=t.TourState.ON,this.showStep(this.currentStep),this.resume$.next()},e.prototype.toggle=function(t){t?this.currentStep?this.pause():this.resume():this.currentStep?this.end():this.start()},e.prototype.next=function(){this.hasNext(this.currentStep)&&this.goToStep(this.loadStep(this.currentStep.nextStep||this.steps.indexOf(this.currentStep)+1))},e.prototype.hasNext=function(t){return t?void 0!==t.nextStep||this.steps.indexOf(t)<this.steps.length-1:(console.warn("Can't get next step. No currentStep."),!1)},e.prototype.prev=function(){this.hasPrev(this.currentStep)&&this.goToStep(this.loadStep(this.currentStep.prevStep||this.steps.indexOf(this.currentStep)-1))},e.prototype.hasPrev=function(t){return t?void 0!==t.prevStep||this.steps.indexOf(t)>0:(console.warn("Can't get previous step. No currentStep."),!1)},e.prototype.goto=function(t){this.goToStep(this.loadStep(t))},e.prototype.register=function(t,e){if(t){if(this.anchors[t])throw new Error("anchorId "+t+" already registered!");this.anchors[t]=e,this.anchorRegister$.next(t)}},e.prototype.unregister=function(t){t&&(delete this.anchors[t],this.anchorUnregister$.next(t))},e.prototype.getStatus=function(){return this.status},e.prototype.isHotkeysEnabled=function(){return this.isHotKeysEnabled},e.prototype.goToStep=function(t){var e=this;if(!t)return console.warn("Can't go to non-existent step"),void this.end();var r=new Promise((function(t){return t(!0)}));void 0!==t.route&&"string"==typeof t.route?r=this.router.navigateByUrl(t.route):t.route&&Array.isArray(t.route)&&(r=this.router.navigate(t.route)),r.then((function(r){!1!==r&&setTimeout((function(){return e.setCurrentStep(t)}))}))},e.prototype.loadStep=function(t){return"number"==typeof t?this.steps[t]:this.steps.find((function(e){return e.stepId===t}))},e.prototype.setCurrentStep=function(t){var e=this;this.currentStep&&this.hideStep(this.currentStep),this.currentStep=t,this.showStep(this.currentStep),this.router.events.pipe(i.filter((function(t){return t instanceof n.NavigationStart})),i.first()).subscribe((function(){e.currentStep&&e.currentStep.hasOwnProperty("route")&&e.hideStep(e.currentStep)}))},e.prototype.showStep=function(t){var e=this.anchors[t&&t.anchorId];if(!e)return console.warn("Can't attach to unregistered anchor with id "+t.anchorId),void this.end();e.showTourStep(t),this.stepShow$.next(t)},e.prototype.hideStep=function(t){var e=this.anchors[t&&t.anchorId];e&&(e.hideTourStep(),this.stepHide$.next(t))},e}();u.decorators=[{type:r.Injectable}],u.ctorParameters=function(){return[{type:n.Router}]};var p=function(){function e(t){this.tourService=t}return e.prototype.onEscapeKey=function(){this.tourService.getStatus()===t.TourState.ON&&this.tourService.isHotkeysEnabled()&&this.tourService.end()},e.prototype.onArrowRightKey=function(){this.tourService.getStatus()===t.TourState.ON&&this.tourService.hasNext(this.tourService.currentStep)&&this.tourService.isHotkeysEnabled()&&this.tourService.next()},e.prototype.onArrowLeftKey=function(){this.tourService.getStatus()===t.TourState.ON&&this.tourService.hasPrev(this.tourService.currentStep)&&this.tourService.isHotkeysEnabled()&&this.tourService.prev()},e}();p.decorators=[{type:r.Component,args:[{selector:"tour-hotkey-listener",template:"<ng-content></ng-content>"}]}],p.ctorParameters=function(){return[{type:u}]},p.propDecorators={onEscapeKey:[{type:r.HostListener,args:["window:keydown.Escape"]}],onArrowRightKey:[{type:r.HostListener,args:["window:keydown.ArrowRight"]}],onArrowLeftKey:[{type:r.HostListener,args:["window:keydown.ArrowLeft"]}]};var a=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[u]}},t}();a.decorators=[{type:r.NgModule,args:[{declarations:[p],exports:[p],imports:[e.CommonModule,n.RouterModule]}]}],t.TourHotkeyListenerComponent=p,t.TourModule=a,t.TourService=u,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-tour-core.umd.min.js.map